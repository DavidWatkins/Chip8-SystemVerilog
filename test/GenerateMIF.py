import sys
import os

fontset = [0xF0, 0x90, 0x90, 0x90, 0xF0, \
		   0x20, 0x60, 0x20, 0x20, 0x70, \
		   0xF0, 0x10, 0xF0, 0x80, 0xF0, \
		   0xF0, 0x10, 0xF0, 0x10, 0xF0, \
		   0x90, 0x90, 0xF0, 0x10, 0x10, \
		   0xF0, 0x80, 0xF0, 0x10, 0xF0, \
		   0xF0, 0x80, 0xF0, 0x90, 0xF0, \
		   0xF0, 0x10, 0x20, 0x40, 0x40, \
		   0xF0, 0x90, 0xF0, 0x90, 0xF0, \
		   0xF0, 0x90, 0xF0, 0x10, 0xF0, \
		   0xF0, 0x90, 0xF0, 0x90, 0x90, \
		   0xE0, 0x90, 0xE0, 0x90, 0xE0, \
		   0xF0, 0x80, 0x80, 0x80, 0xF0, \
		   0xE0, 0x90, 0x90, 0x90, 0xE0, \
		   0xF0, 0x80, 0xF0, 0x80, 0xF0, \
		   0xF0, 0x80, 0xF0, 0x80, 0x80]

if len(sys.argv) == 2:
	filename = sys.argv[1]
	mif = open('new.mif', 'w')
	rom = open(filename, 'rb')

	mif.write('DEPTH = 4096;\n')
	mif.write('WIDTH = 8;\n')
	mif.write('ADDRESS_RADIX = HEX;\n')
	mif.write('DATA_RADIX = HEX;\n')
	mif.write('CONTENT \n')
	mif.write('BEGIN\n')

	for index in range(len(fontset)):
		index_str = hex(index)[2:]
		mif.write(index_str + ' : ' + hex(fontset[index])[2:] + ';\n')

	mif.write('[050..1ff] : 0000;\n')

	byte = rom.read(1)
	index = 0x200
	length = os.path.getsize(filename)

	while index < length + 0x200:
		# Do stuff with byte.
		index_str = hex(index)[2:]
		int_val = int.from_bytes(byte, byteorder='big', signed=False)
		mif.write(index_str + ' : ' + hex(int_val)[2:] + ';\n')
		index += 1;
		byte = rom.read(1)

	if(index < 0xFFF):
		mif.write('[' + hex(index)[2:] + '..' + 'FFF' + '] : 0000;')

	mif.write('END;\n')

else:
	print('Too few arguments')